<!DOCTYPE html>
<html>
<head>
    <title>Test Lead Generation - Local</title>
    <style>
        body { font-family: Arial; max-width: 800px; margin: 50px auto; padding: 20px; }
        button { padding: 10px 20px; background: #4F46E5; color: white; border: none; border-radius: 5px; cursor: pointer; }
        button:disabled { background: #ccc; }
        #results { margin-top: 20px; padding: 20px; background: #f5f5f5; border-radius: 5px; }
        .lead { border: 1px solid #ddd; padding: 10px; margin: 10px 0; border-radius: 5px; background: white; }
    </style>
</head>
<body>
    <h1>üß™ Test Lead Generation (Local)</h1>
    <p>Testing connection to: <code>http://localhost:3001</code></p>
    
    <button onclick="testLeadGen()">Generate 5 Test Leads</button>
    
    <div id="results"></div>

    <script>
        async function testLeadGen() {
            const results = document.getElementById('results');
            results.innerHTML = '<p>‚è≥ Generating leads...</p>';
            
            try {
                const response = await fetch('http://localhost:3001/api/solutions/lead-generation', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        userId: 'test-user',
                        targetIndustry: 'high-end business clients',
                        location: 'USA',
                        criteria: {
                            count: 5,
                            minScore: 7
                        }
                    })
                });

                const data = await response.json();
                
                if (!response.ok) {
                    throw new Error(data.error || 'Failed');
                }

                results.innerHTML = `
                    <h3>‚úÖ Success!</h3>
                    <p>Job ID: ${data.jobId}</p>
                    <p>Status URL: <code>${data.statusUrl}</code></p>
                    <p>Message: ${data.message}</p>
                    <button onclick="checkStatus('${data.jobId}')">Check Status</button>
                `;
                
            } catch (error) {
                results.innerHTML = `<p style="color: red;">‚ùå Error: ${error.message}</p>`;
            }
        }

        async function checkStatus(jobId) {
            const results = document.getElementById('results');
            results.innerHTML += '<p>‚è≥ Checking job status...</p>';
            
            try {
                const response = await fetch(`http://localhost:3001/api/solutions/lead-generation/status/${jobId}`);
                const data = await response.json();
                
                results.innerHTML += `
                    <h4>Job Status:</h4>
                    <pre>${JSON.stringify(data, null, 2)}</pre>
                `;
                
                if (data.state === 'completed' && data.result) {
                    results.innerHTML += `
                        <h4>Leads Found: ${data.result.leadsFound}</h4>
                        <div>${data.result.leads.map(lead => `
                            <div class="lead">
                                <strong>${lead.name}</strong> - ${lead.company}<br>
                                Fit Score: ${lead.fitScore}/10<br>
                                ${lead.description}
                            </div>
                        `).join('')}</div>
                    `;
                }
                
            } catch (error) {
                results.innerHTML += `<p style="color: red;">Error: ${error.message}</p>`;
            }
        }
    </script>
</body>
</html>
